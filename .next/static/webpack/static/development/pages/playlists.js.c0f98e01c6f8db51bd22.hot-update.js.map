{"version":3,"file":"static/webpack/static/development/pages/playlists.js.c0f98e01c6f8db51bd22.hot-update.js","sources":["webpack:///./pages/playlists.js"],"sourcesContent":["import Layout from '../components/MyLayout.js'\nimport React from 'react'\nimport Link from 'next/link'\nimport Router, { withRouter } from 'next/router';\nimport { ACCESS_TOKEN } from '../constants';\n\nexport default class Playlists extends React.Component {\n  static async getInitialProps({ query }) {\n\n    return {}\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      playlists: null,\n      access_token: null,\n    }\n  }\n\n\n  componentDidMount (props) {\n    function getHashParams() {\n      var hashParams = {};\n\n        var e, r = /([^&;=]+)=?([^&;]*)/g,\n            q = window.location.hash.substring(1);\n        while ( e = r.exec(q)) {\n           hashParams[e[1]] = decodeURIComponent(e[2]);\n        }\n\n      return hashParams;\n    }\n\n\n    let params = getHashParams();\n    console.log({params});\n    let access_token = params.access_token\n        // state = params.state,\n        // storedState = sessionStorage.getItem(STATE_KEY);\n   this.setState({access_token: access_token});\n\n    if (!access_token) {\n      alert('There was an error during the authentication');\n    } else {\n      // sessionStorage.removeItem(STATE_KEY);\n      if (access_token) {\n        fetch('https://api.spotify.com/v1/me', {\n            headers: {\n              'Authorization': 'Bearer ' + access_token\n            }\n        }).then(res => res.json())\n          .then(response => console.log('Success:', JSON.stringify(response)))\n          .catch(error => console.error('Error:', error));;\n      }\n    }\n\n    if (access_token !== null) {\n      fetch('https://api.spotify.com/v1/me/playlists', {\n          headers: {\n            'Authorization': 'Bearer ' + access_token\n          }\n      }).then(res => res.json())\n        .then(response => this.setState({playlists: response.items}))\n        .catch(error => console.error('Error:', error));\n    } else {\n      alert(\"you are not logged in\");\n    }\n  }\n\n  getTrackInfo (queryParam) {\n    console.log(\"called get track info query param\", queryParam);\n    // llo: throw access token and query param in url, redirec to tracks, make API call\n\n    let path = '/tracks';\n    url += '?response_type=token';\n    url += '?access_token=' + encodeURIComponent(this.state.access_token);\n    url += '&scope=' + encodeURIComponent(scope);\n    url += '&redirect_uri=' + encodeURIComponent(redirect_uri);\n    url += '&state=' + encodeURIComponent(state);\n\n\n    window.location = url;\n\n    Router.pushRoute('/blog/hello-world')\n};\n\n  render () {\n    let playlists = this.state.playlists;\n    console.log(playlists);\n    return  (\n          <Layout>\n             <p>Playlists</p>\n              <div className=\"playlistContainer\">\n               { playlists &&\n                 playlists.map((playlist, index) => (\n                    <div className=\"playlist\" key={index} onClick={() => this.getTrackInfo(playlist.tracks.href)}>\n                      <img src={playlist.images[0].url}/>\n                      <p>{playlist.name}</p>\n                    </div>\n\n                ))\n               }\n               </div>\n             <style jsx>{`\n               p {\n                 font-family: 'Arial';\n                 font-weight: bold;\n               }\n               .playlistContainer {\n                 display: flex;\n                 flex-direction: row;\n                 flex-flow: wrap;\n               }\n               .playlist {\n                 flex: 1;\n               }\n               img {\n                  height: 300px;\n                  width: 300px;\n               }\n\n               img:hover {\n                 cursor: pointer;\n               }\n             `}</style>\n          </Layout>\n      )\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AACA;AAEA;AACA;;;;;;;;;;;;;;;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAFA;AAMA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAIA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAIA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAHA;AAJA;AAAA;AAqCA;;;;AA1HA;AACA;;;;;A","sourceRoot":""}